import numpy as np
cimport numpy as cnp
cimport cython
ctypedef cnp.float64_t DTYPE_t

cpdef inline cnp.ndarray[DTYPE_t, ndim=3] phi0(DTYPE_t[:] z):
    cdef DTYPE_t y = z[0]
    cdef DTYPE_t mu = z[1]
    cdef DTYPE_t sig = z[2]
    return np.array([[[(-104222/9*y+33046/3*mu)/(10478*sig+68921)]],[[(33046/3*y-10478*mu)/(10478*sig+68921)]],[[(546019058/9*y**2-346255988/3*mu*y+54894242*mu**2-54894242*sig-361077119)/(109788484*sig**2+1444308476*sig+4750104241)]]])

cpdef inline cnp.ndarray[DTYPE_t, ndim=3] phi1(DTYPE_t[:] z):
    cdef DTYPE_t y = z[0]
    cdef DTYPE_t mu = z[1]
    cdef DTYPE_t sig = z[2]
    return np.array([[[((-1092038116*sig-10336633738/9)*y**2+(1038767964*sig-13943131826/3)*mu*y+5460190580*mu**2+988096356*sig**2+7538585704*sig+6835515859)/((988096356*sig**2+7538585704*sig+6835515859)*y+(5193839820*sig+34163450490)*mu)]],[[((1038767964*sig+3277469234/3)*y**2+(-988096356*sig+4420993018)*mu*y-5193839820*mu**2+5193839820*sig+34163450490)/((988096356*sig**2+7538585704*sig+6835515859)*y+(5193839820*sig+34163450490)*mu)]],[[((5721187689724*sig+54153624153382/9)*y**3+(-10884210726792*sig+18625802106496)*mu*y**2+((5176636809084*sig-51767520869922)*mu**2-5176636809084*sig**2+17717226393984*sig+340510527378879)*y+27210526816980*mu**3+(-81631580450940*sig-536946951351330)*mu)/((10353273618168*sig**3+147089889958388*sig**2+591189400475986*sig+471110588518139)*y+(54421053633960*sig**2+715929268468440*sig+2354579171221290)*mu)]]])

cpdef inline cnp.ndarray[DTYPE_t, ndim=3] phi2(DTYPE_t[:] z):
    cdef DTYPE_t y = z[0]
    cdef DTYPE_t mu = z[1]
    cdef DTYPE_t sig = z[2]
    return np.array([[[((-102981378415032*sig**2-216614496613528*sig-1025176997501102/9)*y**3+(97957896541128*sig**2-876576811636968*sig-1030262621300198)*mu*y**2+((1029813784150320*sig-1762287430076160)*mu**2+186358925127024*sig**3+1102897343025504*sig**2-1143887980066572*sig-2206176414523968)*y+2706561868600200*mu**3+(1469368448116920*sig**2+11210404642847280*sig+10164890568443130)*mu)/((93179462563512*sig**3+808902117550332*sig**2+1392272208072434*sig+677939627379761)*y**2+(979578965411280*sig**2+7473603095231520*sig+6776593712295420)*mu*y+(2574534460375800*sig+16934480773388100)*mu**2+465897312817560*sig**3+6619045048127460*sig**2+26603523021419370*sig+21199976483316255)]],[[((97957896541128*sig**2+206047935803112*sig+325056121158886/3)*y**3+(-93179462563512*sig**2+833816967166872*sig+980005908066042)*mu*y**2+((-979578965411280*sig+1676322189584640)*mu**2+1469368448116920*sig**2+11210404642847280*sig+10164890568443130)*y-2574534460375800*mu**3+(-465897312817560*sig**2+1594550375458560*sig+30645947464099110)*mu)/((93179462563512*sig**3+808902117550332*sig**2+1392272208072434*sig+677939627379761)*y**2+(979578965411280*sig**2+7473603095231520*sig+6776593712295420)*mu*y+(2574534460375800*sig+16934480773388100)*mu**2+465897312817560*sig**3+6619045048127460*sig**2+26603523021419370*sig+21199976483316255)]],[[((539519441516352648*sig**2+1134843347758273192*sig+5370902289908273378/9)*y**4+(-1026402839957939184*sig**2+3512900780493571584*sig+14489668600223808212/3)*mu*y**3+((488167204370239368*sig**2-9763561506150768888*sig+4098372893811008202)*mu**2-488167204370239368*sig**3+9250147844062626852*sig**2+95611172520667189074*sig+89756322549038452671)*y**2+((5132014199789695920*sig-22961929580830376760)*mu**3+(-20528056799158783680*sig**2-99898115945285941920*sig+231067603256725946880)*mu)*y+13487986037908816200*mu**4+(2440836021851196840*sig**2-48817807530753844440*sig-426713353079756004990)*mu**2-2440836021851196840*sig**3-7701204931322130540*sig**2+215503121977904944170*sig+1056074672586587380155)/((976334408740478736*sig**4+14897698127032189248*sig**3+70338571039869395224*sig**2+103060244268245359472*sig+46724277058640507881)*y**2+(10264028399579391840*sig**3+145821975106946695440*sig**2+586093347843883000680*sig+467049615245112641820)*mu*y+(26975972075817632400*sig**2+354878979087121023600*sig+1167141349382681240100)*mu**2+4881672043702393680*sig**4+101464462710978578640*sig**3+734942917980424829520*sig**2+2055674763751432119660*sig+1461123579206639610855)]]])

